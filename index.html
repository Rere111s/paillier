<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="https://pyscript.net/alpha/pyscript.css"/>
    <script defer src="https://pyscript.net/alpha/pyscript.js"></script>
</head>
<body>
    <py-script>
import random
import math

def L(x, n):
    return (x - 1) // n

def paillier_encrypt(m, pk):
    n, g = pk
    nn = n * n
    assert(0 <= m < n)
    while True:
        r = random.randint(2, n)
        if math.gcd(r, n) == 1:
            break
    return (pow(g, m, nn) * pow(r, n, nn)) % nn

def paillier_decrypt(c, pk, sk):
    n, g = pk
    λ, μ = sk
    assert(0 <= c < n*n)
    return (L(pow(c, λ, n*n), n) * μ) % n

pk=(586781292837183334363479408991455919380605766363629683747343356449021202568064548904295359217705339539913948243876590284523803356312423563973754967725300488667556453090069948346821404046940578792926906982557850555939166753675679924395099277965377153593266443585167985045863968329917489052794474922335039859463197153049276895749474999571799831116422571421787646081421017471055318503684544532571728721339262836465345159660727970958634068950952380386703928849517983895182417196353343802802027835709894946212675650993704507059815720609464821986499654957336860862516931368987265173176828391767416749579824155631178530368094192561636948627224149048855388995354334767501959467937000860571304976870073104315664499702051674875669940628477684174640085506288730548957992144674271229460730493311408103527245568262410381218279755691762978450799273748135296536488769146432692027403517521132629397291775384141888398365629702485448009656106554840837244035244782896224935410254235111433752762772953862012064652240184337536092006134506415341095911499552248464779896018200030398885624355824566727679605878125569091286618763723679641875548786184234048145780932810044111791889395360238474414518033544252759678135819500028593682658827171106817961047907003, 272063249678241362326150188918326678109807847425471319763320371688719465673377145628800141859151475142684400963044002345532570981364277017914597371497982609061359889717703589446585010194076206158188864778775625562741977361495150437826093205628993556413533486688043384141222351273134014629574270616486923931783081815422327325085589356067136958306042016735647233634737226706874589905626883118548504689254128706221758706994637952975023679776460144538882821486633623979700716451324523842626211132650717576207731490753907900975468314754865339188264391740422943381750708464000874322985970206219022247082076229269072794155593637605327237472910799672564186046669089782044946776577106723941184519702248535618691783391197750566351590119347559159583749597114407116693426066196341343393377684560459348333647892267927220838938748504091077347480109224223787168142592938102119321468174035071820448823133473016680715045467254087388451795230300695068582465508232104259079542477194189446050947958473702363462862011405437594919785748066471673008582343822406597707137056919136667935066944771840836684208922475677148847394543245984107880373138234558261243037658035223452945178347865788764484763039040892060134369094599985112613060856979524906556363773179135709496498917147355354801669487381014163244592271329116242786070366368307544582340772985893061372157991211001741796844723861263307811143460142348445722604444603560961691751419052405150028820439151081344434760193755458619853563277588965188061840080447624210669242346953862710626519394409169254484787507671284730631985595788048451996900661812651200119025022963068650211491257952010969326786978188102084690994190885674945765421623838324955870349878314306706862239741510782457430875323222805458696717215322903529923500840466368083047281097419854747923359139114217914789777037984225269607170310537664823336425083001868386898378009992406733815655337308875693870729549828626214609536240675813574851992021776457031963062001114723150337006720359308746523185301519729838676930215060691582204997142424894200385117734181208429744862662816281781397005735031784868157861593733475490590261108001512732817469294746558240282364750156690910603361935774574801701619543811557356331802504981828830018457232036610015046867260773813518980958633688413769164099543132644530878237144369178584357404832087120168150497003912200679344329995010487026924204716029079797916928432457770892614822359978351507703604641509107322145208150239431016729531205493636154858)
sk=(293390646418591667181739704495727959690302883181814841873671678224510601284032274452147679608852669769956974121938295142261901678156211781986877483862650244333778226545034974173410702023470289396463453491278925277969583376837839962197549638982688576796633221792583992522931984164958744526397237461167519929731598576524638447874737499785899915558211285710893823040710508735527659251842272266285864360669631418232672579830363985479317034475476190193351964424758991947591208598176671901401013917854947473106337825496852253529907860304732410993249827478668430431258465684493632586588414195883708374789912077815589265184021928807474745640748597526724263810525951503638241030935031834101066267117429925136505128266168853760428037857826374429165857157953370394522375416853595951740534183569480307482961607007427228559293208002220744119922238756904860167774432012335201172785124322609416174120643356566481076741498289208134511182414345161724638621733436545780750378931282355030148469679181603398817621504676619215658236213476579009093029676761257260800065585391333465319951684054072123905818080102519602814158288948439890481131344226142760323985414730277295407111506860882987957825690417080513885986343402422751046280471906923099611679915664, 371925591782093597130209993440944518695434738672119610893861616187060476139904098334327632648711078009874183560863653577619358688480151742430541686421369398551727985913184854113878341535284209475341948310147848326581700229733813188800633717983460176853568551817250943908779104862009710621266540318606004443779268329080658250978091690222138344714863927174867109944480582910454918017147569787248716865148589626014855532217405646285410344970625251792436482635749775882126701077231728261292774608103940592587864906187886500493375532619079405305293820199121580404760955066557814481768873478238730424061714105991635257201874810538810656313485970602822738831180359333865222674016778027007914440747190568793701431285434387979504529874552912468523915240632142399126300790015033885398461492748137944023133590256176990637941044024429532904748223153421112438560613285557722609801321023247490294186451557904190571708603255738607510164591604192770895203028438839535861992578983468556774699394716778242229761510151183684885009916658987461847792864261243547307595912250818014234690059802657561806047692116924699363245375465948773409323046600639993152160609706282795718663725839620119355028288255785611972855094898930706362073925048669502272498931541)
n, _ = pk

print('pk:', pk)
print()
print('sk:', sk)
print()

m1 = 0
c1 = paillier_encrypt(m1, pk)
m2 = 1
c2 = paillier_encrypt(m2, pk)
m3 = 0
c3 = paillier_encrypt(m3, pk)
m4 = 1
c4 = paillier_encrypt(m4, pk)


c = (c1 * c2 * c3 * c4) % (n*n)
print('c1 * c2 * c3 * c4 :', c)
d = paillier_decrypt(c, pk, sk)
print('d:', d)
    </py-script>
</body>
</html>